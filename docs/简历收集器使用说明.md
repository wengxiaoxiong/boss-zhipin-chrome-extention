# 简历收集器使用说明

## 功能概述

简历收集器是 BOSS 直聘助手的一个核心功能，可以自动遍历聊天页面中的候选人，智能处理不同的简历状态，并自动收集保存简历。

## 使用步骤

1. **打开聊天页面**
   - 访问 `https://www.zhipin.com/web/chat/index`
   - 确保你已经和一些候选人有过沟通

2. **打开侧边栏**
   - 点击浏览器右上角的扩展图标
   - 选择"打开侧边栏"

3. **启动简历收集器**
   - 在侧边栏中找到"简历收集器"卡片
   - 点击"开始收集"按钮

4. **监控收集进度**
   - 查看"已处理候选人"数量
   - 查看"已获得简历"、"已同意"、"已求简历"的统计
   - 当前正在处理的候选人名称会实时显示

5. **停止收集**
   - 点击"停止"按钮即可停止收集

## 智能处理逻辑

简历收集器会自动识别以下 4 种情况并智能处理：

### 情况 0：没有回复
- **识别**：你发送了消息，但候选人没有回复
- **处理**：跳过该候选人，继续下一个

### 情况 1：需要求简历
- **识别**：页面上有"求简历"按钮
- **处理**：自动点击"求简历"按钮，发送简历请求

### 情况 2：对方要发简历
- **识别**：消息中显示"对方想发送附件简历给您，您是否同意"
- **处理**：自动点击"同意"按钮
- **后续**：同意后如果立即有简历，会自动预览并保存

### 情况 3：已有简历
- **识别**：消息中有"点击预览附件简历"按钮
- **处理**：
  1. 自动点击预览按钮
  2. 等待 PDF 加载完成
  3. 提取简历文本内容（支持多页）
  4. 保存到本地存储
  5. 自动关闭预览窗口

### 情况 4：已收集过
- **识别**：按钮显示为禁用状态（已处理过）
- **处理**：跳过该候选人，继续下一个

## 简历存储

所有收集的简历会保存到 Chrome 的本地存储中，每条简历包含：
- **候选人姓名**
- **简历内容**：完整的文本内容
- **收集时间**：ISO 格式的时间戳

### 查看已收集的简历

你可以在浏览器的开发者工具中查看：
1. 按 F12 打开开发者工具
2. 选择 Console 标签
3. 输入：
```javascript
chrome.storage.local.get('collectedResumes', (result) => {
  console.log(result.collectedResumes)
})
```

### 导出简历数据

```javascript
chrome.storage.local.get('collectedResumes', (result) => {
  const resumes = result.collectedResumes || []
  const json = JSON.stringify(resumes, null, 2)
  const blob = new Blob([json], { type: 'application/json' })
  const url = URL.createObjectURL(blob)
  const a = document.createElement('a')
  a.href = url
  a.download = 'resumes.json'
  a.click()
})
```

### 清空简历数据

```javascript
chrome.storage.local.remove('collectedResumes', () => {
  console.log('简历数据已清空')
})
```

## 注意事项

1. **自动等待时间**：
   - 每选中一个候选人后会等待 1.5 秒加载对话
   - 每处理完一个候选人后会等待 2 秒再继续
   - 简历预览需要等待 3 秒让 PDF 完全加载

2. **已处理记录**：
   - 已处理过的候选人会被记录，避免重复处理
   - 刷新页面或重启浏览器后记录会清空

3. **错误处理**：
   - 如果某个候选人处理失败，会自动跳过继续下一个
   - 所有操作都有详细的控制台日志输出

4. **性能建议**：
   - 建议一次处理不超过 50 个候选人
   - 如果候选人太多，可以分批次收集

## 技术实现

- **DOM 选择器**：基于 BOSS 直聘页面结构精确定位元素
- **状态机**：智能识别当前对话状态
- **异步处理**：合理的等待时间确保页面元素加载完成
- **数据持久化**：使用 Chrome Storage API 本地存储

## 常见问题

**Q: 为什么有些候选人被跳过了？**
A: 可能是情况 0（没有回复）或情况 4（已处理过），这是正常的。

**Q: 简历收集后存储在哪里？**
A: 存储在 Chrome 的本地存储中，数据不会上传到服务器。

**Q: 可以导出简历吗？**
A: 可以，使用上面提供的导出脚本即可导出 JSON 格式的简历数据。

**Q: 收集器会一直运行吗？**
A: 不会，它会遍历当前页面显示的所有候选人，然后自动停止。你可以随时点击"停止"按钮。

## 更新日志

- **v1.0.0** (2024-12-21): 初始版本
  - 支持 4 种情况的智能识别和处理
  - 自动简历文本提取
  - 本地存储功能

